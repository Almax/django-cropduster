{% extends parent_template %}

<!-- LOADING -->
{% load i18n adminmedia %}

<!-- STYLESHEETS -->
{% block stylesheets %}
    {{ block.super }}
    <link rel="stylesheet" href="{{ STATIC_URL }}cropduster/css/jquery.Jcrop.css" type="text/css" />
{% endblock %}

<!-- JAVASCRIPTS -->
{% block javascripts %}
    {{ block.super }}
    <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}cropduster/js/json2.js"></script>
    <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}cropduster/js/jquery.class.js"></script>
    <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}cropduster/js/jquery.form.js?v=1"></script>
    <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}cropduster/js/jquery.Jcrop.js?v=2"></script>
    <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}cropduster/js/upload.js"></script>
    <script language="javascript" type="text/javascript" src="{{ STATIC_URL }}cropduster/js/CropDuster.js"></script>
{% endblock %}

<!-- Get rid of nav -->
{% block nav-global %}{% endblock %}

{% block bodyclass %}{{ block.super }} cropduster-form absolute-pos{% endblock %}

{% block content-class %}content-flexible{% endblock %}

{% block breadcrumbs %}{% endblock %}


<!-- CONTENT -->
{% block content %}
<h1 id="step-header">Upload, Crop, and Generate Thumbnails</h1>
<div id="content-main">
    <form id="upload" action="{{ request.path }}?upload_to={{ upload_to|urlencode }}" method="POST">
        <input type="hidden" id="image-element-id" name="image_element_id" value="{{ image_element_id }}" />
        <input type="hidden" id="upload-sizes" name="sizes" value="[]" />
        <fieldset class="module aligned">
            <div class="row">
                <input type="file" name="picture" id="picture" />
            </div>
        </fieldset>
        <div class="module footer" id="upload-footer"{% if image_id %} style="display: none"{% endif %}>
            <ul class="submit-row">
                <li class="submit-button-container">
                    <input id="upload-button" class="default" type="submit" name="_save" value='Upload' />
                </li>
            </ul>
        </div>
    </form>

    <div id="error-container" style="display:none">
        <p class="errornote"></p>
    </div>

    <form action="{% url cropduster.views.crop %}" method="POST" id="crop-form">
        <div id="image-container">
            <img src="{{ image }}" id="cropbox" />
        </div>
        <div style="display:none">{{ thumb_form.as_p }}</div>
        <div class="module footer" id="crop-footer"{% if not image_id %} style="display:none"{% endif %}>
            <ul class="submit-row">
                <li class="submit-button-container">
                    <input id="crop-button" class="default" type="submit" name="crop" value="Crop and Generate Thumbs" />
                </li>
                <li class="submit-button-container">
                    <input id="reupload-button" type="submit" name="_save" value='Re-Upload' onclick="return uploadSubmit();" />
                </li>
            </ul>
        </div>
    </form>

</div>
{% endblock %}