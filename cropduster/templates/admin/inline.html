
<style type="text/css">
.cropduster_thumbs {
	overflow: hidden;
    padding: 15px;
}
.cropduster_thumbs img {
	display: block;
	float: left;
    border:1px solid black;
    box-shadow: 0 0 3px 3px #888;
    max-width: 100%;
}

.cropduster_thumbs img.original {
    float:none;
    max-width: 100%;
    margin: 0;
}
.cropduster_thumbs a {
    float:left;
    display: block;
    width: auto;
    max-width:20%;
    margin-top:10px;
    margin-right: 15px;
    margin-bottom: 15px;
}
</style>

<script type="text/javascript">
function cropduster_pop(id, size_set_id, image_id){


	href = '{{ cropduster_url }}?pop=1&size_set=' + size_set_id + '&image_element_id=' + id;
	if (django.jQuery("#cropduster_input_" + id + " input").val() != ''){
		image_id = django.jQuery("#cropduster_input_" + id + " input").val();
	}
	
	if (image_id){
		href += '&image_id=' + image_id;
	}

	var win=window.open(href, id, 'height=650, width=960, resizable=yes, scrollbars=yes');

	return false;
}

(function($) {
  window.toggle_delete = function(obj){
	var container = $(obj).parent().parent().parent().parent();
	
	$(container).toggleClass("predelete");
	
	// Swap the title and the value fields, that way the values can be swapped back if deletion is canceled
	var tempValue = $(container).find("input.cropduster").val();
	var tempTitle = $(container).find("input.cropduster").attr("title");

	$(container).find("input.cropduster").val(tempTitle);
	$(container).find("input.cropduster").attr("title", tempValue);

	return false;
  };
  $(function() {
      $('a.cd_show').click(function(e) {
        e.preventDefault();
        cropduster_pop('{{ attrs["id"] }}', 
                        {{ size_set.id }}
                        {% if image %}, {{ image.id }}{% endif %});
        return false;
      });
  });
})((typeof window.django == 'object') ? django.jQuery : jQuery);

</script>

<div class="tools">
	<a href="javascript://" onclick="toggle_delete(this);" class="icon delete-handler" title="Remove"></a>

</div>

<p><a href="#" class="cd_show"><img src="{{ media_url }}/img/cropduster_icon_upload_select.png" alt=""></a></p>

	<div class="cropduster_thumbs">
	{% if image %}
        <h4>Original Image</h4>
        <hr />
        <a title="Original image" alt="Original Image" href="{{image|safe}}" target="_blank">
            <img class="original" src="{{ image|safe }}"/>
        </a>
        <div style="clear:both;height:10px;"></div>
        <h4>Manually Cropped</h4>
        <hr />
        {% for image in image.derived.filter(size__size_set=size_set, size__auto_crop=False) %}
            <a href="{{image|safe}}"><img src="{{ image|safe }}" /></a>
        {% endfor %}
        <div style="clear:both;height:10px;"></div>
        <h4>Auto Cropped</h4>
        <hr />
        {% for image in image.derived.filter(size__size_set=size_set, size__auto_crop=True) %}
            <a href="{{image|safe}}"><img src="{{ image|safe }}" /></a>
        {% endfor %}
	{% endif %}
	</div>
<div id="cropduster_input_{{ attrs["id"] }}">
{{ input|safe }}

</div>
